–≠—Ç–æ –Ω–µ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç —Å–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞ –Ω–∞ –Ω–µ–¥–µ–ª–∏, –Ω–æ —ç—Ç–æ –±—É–¥–µ—Ç **–ø—Ä–æ—á–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç**, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å—Ç—Ä–æ–∏—Ç—å –¥–∞–ª—å—à–µ. –í—Å–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö, –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã) –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –∞ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã "–∑–∞–≥–ª—É—à–∫–∏", —á—Ç–æ–±—ã –≤—ã —á–µ—Ç–∫–æ –≤–∏–¥–µ–ª–∏, –≥–¥–µ –∏ —á—Ç–æ –¥–æ–ø–∏—Å—ã–≤–∞—Ç—å.

–ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–∏ —Ñ–∞–π–ª—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞–ø–∫–∏, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ .env –∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ.

---

### –®–∞–≥ 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ)

      `/study_group_bot ‚îú‚îÄ‚îÄ .env ‚îú‚îÄ‚îÄ requirements.txt ‚îú‚îÄ‚îÄ bot.py ‚îÇ ‚îî‚îÄ‚îÄ app/     ‚îú‚îÄ‚îÄ __init__.py     ‚îú‚îÄ‚îÄ config.py     ‚îú‚îÄ‚îÄ handlers/     ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py     ‚îÇ   ‚îú‚îÄ‚îÄ admin.py     ‚îÇ   ‚îú‚îÄ‚îÄ common.py     ‚îÇ   ‚îú‚îÄ‚îÄ group_assistant.py     ‚îÇ   ‚îú‚îÄ‚îÄ group_leader.py     ‚îÇ   ‚îî‚îÄ‚îÄ group_member.py     ‚îú‚îÄ‚îÄ keyboards/     ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py     ‚îÇ   ‚îú‚îÄ‚îÄ inline.py     ‚îÇ   ‚îî‚îÄ‚îÄ reply.py     ‚îú‚îÄ‚îÄ middlewares/     ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py     ‚îÇ   ‚îî‚îÄ‚îÄ db.py     ‚îú‚îÄ‚îÄ db/     ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py     ‚îÇ   ‚îú‚îÄ‚îÄ models.py     ‚îÇ   ‚îî‚îÄ‚îÄ repository.py     ‚îî‚îÄ‚îÄ utils/         ‚îú‚îÄ‚îÄ __init__.py         ‚îî‚îÄ‚îÄ tools.py`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487).

IGNORE_WHEN_COPYING_END

---

### –®–∞–≥ 2: –ö–æ–¥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞

#### 1. –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

**requirements.txt**

      `aiogram==3.3.0 sqlalchemy[asyncio]==2.0.25 asyncpg==0.29.0 alembic==1.13.1 python-dotenv==1.0.0`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Text

IGNORE_WHEN_COPYING_END

**.env** (—Å–æ–∑–¥–∞–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ)

      `# –í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç @BotFather BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11  # –°—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL # –§–æ—Ä–º–∞—Ç: postgresql+asyncpg://<user>:<password>@<host>:<port>/<dbname> DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/stud_bot_db`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Env

IGNORE_WHEN_COPYING_END

**bot.py** (–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞)

      `import asyncio import logging from os import getenv  from aiogram import Bot, Dispatcher from aiogram.fsm.storage.memory import MemoryStorage from dotenv import load_dotenv from sqlalchemy.ext.asyncio import create_async_engine, async_sessionmaker  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–æ—É—Ç–µ—Ä—ã –∏–∑ handlers from app.handlers import common, group_leader from app.middlewares.db import DbSessionMiddleware  # –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ .env load_dotenv()  # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(name)s - %(message)s') logger = logging.getLogger(__name__)  async def main():     logger.info("Starting bot...")      # –°–æ–∑–¥–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è SQLAlchemy     engine = create_async_engine(getenv("DATABASE_URL"), echo=False) # echo=True –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤          # –°–æ–∑–¥–∞–µ–º —Ñ–∞–±—Ä–∏–∫—É —Å–µ—Å—Å–∏–π     session_maker = async_sessionmaker(engine, expire_on_commit=False)      # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –ë–æ—Ç–∞ –∏ –î–∏—Å–ø–µ—Ç—á–µ—Ä–∞     bot = Bot(token=getenv("BOT_TOKEN"))     dp = Dispatcher(storage=MemoryStorage())      # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º middleware –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–µ—Å—Å–∏–∏ –≤ —Ö—ç–Ω–¥–ª–µ—Ä—ã     # –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω–æ –ø–µ—Ä–µ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π —Ä–æ—É—Ç–µ—Ä–æ–≤     dp.update.middleware(DbSessionMiddleware(session_pool=session_maker))      # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Ä–æ—É—Ç–µ—Ä—ã     dp.include_router(common.router)     dp.include_router(group_leader.router)     # ... –∑–¥–µ—Å—å –±—É–¥—É—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥—Ä—É–≥–∏–µ —Ä–æ—É—Ç–µ—Ä—ã (admin, group_assistant, etc.) ...      # –£–¥–∞–ª—è–µ–º –≤–µ–±—Ö—É–∫ –∏ –∑–∞–ø—É—Å–∫–∞–µ–º polling     await bot.delete_webhook(drop_pending_updates=True)     try:         await dp.start_polling(bot)     finally:         await bot.session.close()         await engine.dispose()  if __name__ == "__main__":     try:         asyncio.run(main())     except (KeyboardInterrupt, SystemExit):         logger.info("Bot stopped!")`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

---

#### 2. –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è app/

**app/config.py**

      `from os import getenv from dotenv import load_dotenv  load_dotenv()  class Settings:     BOT_TOKEN = getenv("BOT_TOKEN")     DATABASE_URL = getenv("DATABASE_URL")  settings = Settings()`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

---

#### 3. –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è app/db/

**app/db/models.py** (ORM-–º–æ–¥–µ–ª–∏, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã)

      `from sqlalchemy import (     BigInteger, String, Column, DateTime, func, JSONB, Boolean,     UUID, ForeignKey, INT ) from sqlalchemy.orm import DeclarativeBase, relationship  class Base(DeclarativeBase):     pass  class User(Base):     __tablename__ = 'users'      telegram_id = Column(BigInteger, primary_key=True)     telegram_username = Column(String, nullable=True)     first_name = Column(String, nullable=False)     last_name = Column(String, nullable=True)     middle_name = Column(String, nullable=True)     created_at = Column(DateTime(timezone=True), server_default=func.now())     last_active_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())     notification_settings = Column(JSONB, nullable=True)      # –°–≤—è–∑—å —Å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –≥—Ä—É–ø–ø—ã     group_membership = relationship("GroupMember", back_populates="user", uselist=False, cascade="all, delete-orphan")      def __repr__(self):         return f"<User(id={self.telegram_id}, name='{self.first_name}')>"  class Group(Base):     __tablename__ = 'groups'          id = Column(UUID(as_uuid=True), primary_key=True, server_default=func.uuid_generate_v4())     name = Column(String, nullable=False)     description = Column(String, nullable=True)     creator_id = Column(BigInteger, ForeignKey('users.telegram_id', ondelete='SET NULL'))     created_at = Column(DateTime(timezone=True), server_default=func.now())      # –°–≤—è–∑—å —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏     members = relationship("GroupMember", back_populates="group", cascade="all, delete-orphan")  class GroupMember(Base):     __tablename__ = 'groupmembers'      id = Column(UUID(as_uuid=True), primary_key=True, server_default=func.uuid_generate_v4())     user_id = Column(BigInteger, ForeignKey('users.telegram_id', ondelete='CASCADE'), unique=True, nullable=False)     group_id = Column(UUID(as_uuid=True), ForeignKey('groups.id', ondelete='CASCADE'), nullable=False)     is_leader = Column(Boolean, default=False, nullable=False)     is_assistant = Column(Boolean, default=False, nullable=False)     joined_at = Column(DateTime(timezone=True), server_default=func.now())          # –û–±—Ä–∞—Ç–Ω—ã–µ —Å–≤—è–∑–∏     user = relationship("User", back_populates="group_membership")     group = relationship("Group", back_populates="members")`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –Ø –¥–æ–±–∞–≤–∏–ª —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞. –û—Å—Ç–∞–ª—å–Ω—ã–µ (Events, Topics –∏ —Ç.–¥.) –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏.

**app/db/repository.py** (–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö)

      `from sqlalchemy.ext.asyncio import AsyncSession from sqlalchemy.future import select from sqlalchemy.orm import selectinload  from app.db.models import User, Group, GroupMember from uuid import UUID  class UserRepo:     def __init__(self, session: AsyncSession):         self.session = session      async def get_or_create_user(self, telegram_id: int, username: str, first_name: str, last_name: str | None) -> User:         stmt = select(User).where(User.telegram_id == telegram_id)         result = await self.session.execute(stmt)         user = result.scalar_one_or_none()          if not user:             user = User(                 telegram_id=telegram_id,                 telegram_username=username,                 first_name=first_name,                 last_name=last_name             )             self.session.add(user)             await self.session.commit()             await self.session.refresh(user)         return user      async def get_user_with_group_info(self, telegram_id: int) -> User | None:         """ –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –µ–≥–æ –≥—Ä—É–ø–ø–µ –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º """         stmt = (             select(User)             .options(selectinload(User.group_membership).selectinload(GroupMember.group))             .where(User.telegram_id == telegram_id)         )         result = await self.session.execute(stmt)         return result.scalar_one_or_none()  class GroupRepo:     def __init__(self, session: AsyncSession):         self.session = session          async def create_group(self, name: str, creator_id: int) -> Group:         """ –°–æ–∑–¥–∞–µ—Ç –≥—Ä—É–ø–ø—É –∏ –¥–µ–ª–∞–µ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è —Å—Ç–∞—Ä–æ—Å—Ç–æ–π """         # –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—É         new_group = Group(name=name, creator_id=creator_id)         self.session.add(new_group)         await self.session.flush() # –ü–æ–ª—É—á–∞–µ–º group.id –¥–æ –∫–æ–º–º–∏—Ç–∞          # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–∑–¥–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É –∫–∞–∫ —Å—Ç–∞—Ä–æ—Å—Ç—É         membership = GroupMember(             user_id=creator_id,             group_id=new_group.id,             is_leader=True         )         self.session.add(membership)         await self.session.commit()         await self.session.refresh(new_group)         return new_group`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

---

#### 4. –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è app/middlewares/

**app/middlewares/db.py** (–î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–µ—Å—Å–∏–∏ –ë–î –≤ —Ö—ç–Ω–¥–ª–µ—Ä—ã)

      `from typing import Callable, Dict, Any, Awaitable from aiogram import BaseMiddleware from aiogram.types import TelegramObject from sqlalchemy.ext.asyncio import async_sessionmaker  class DbSessionMiddleware(BaseMiddleware):     def __init__(self, session_pool: async_sessionmaker):         super().__init__()         self.session_pool = session_pool      async def __call__(         self,         handler: Callable[[TelegramObject, Dict[str, Any]], Awaitable[Any]],         event: TelegramObject,         data: Dict[str, Any],     ) -> Any:         async with self.session_pool() as session:             data["session"] = session             return await handler(event, data)`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

---

#### 5. –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è app/keyboards/

**app/keyboards/reply.py**

      `from aiogram.types import ReplyKeyboardMarkup, KeyboardButton  # –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ –≥—Ä—É–ø–ø–µ main_menu_unregistered = ReplyKeyboardMarkup(     keyboard=[         [KeyboardButton(text="üöÄ –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É")],         [KeyboardButton(text="üîó –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ø–æ —Å—Å—ã–ª–∫–µ")]     ],     resize_keyboard=True )  # –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è —Å—Ç–∞—Ä–æ—Å—Ç—ã main_menu_leader = ReplyKeyboardMarkup(     keyboard=[         [KeyboardButton(text="üìÖ –°–æ–±—ã—Ç–∏—è –∏ –ë—Ä–æ–Ω—å")],         [KeyboardButton(text="üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã")],         [KeyboardButton(text="‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä—É–ø–ø—ã")]     ],     resize_keyboard=True )  # ... –î–æ–±–∞–≤—å—Ç–µ –∑–¥–µ—Å—å –¥—Ä—É–≥–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

**app/keyboards/inline.py**

      `from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton  # –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤–∞—à–∏ –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏–ª–∏ –≤—ã–±–æ—Ä–∞ —Ç–µ–º # –ü—Ä–∏–º–µ—Ä: def get_example_inline_keyboard():     return InlineKeyboardMarkup(         inline_keyboard=[             [InlineKeyboardButton(text="–ö–Ω–æ–ø–∫–∞ 1", callback_data="button1_pressed")],             [InlineKeyboardButton(text="–ö–Ω–æ–ø–∫–∞ 2", callback_data="button2_pressed")]         ]     )`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

---

#### 6. –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è app/handlers/

**app/handlers/common.py** (–û–±—â–∏–µ –∫–æ–º–∞–Ω–¥—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

      `from aiogram import Router, F from aiogram.types import Message from aiogram.filters import CommandStart from aiogram.fsm.context import FSMContext from sqlalchemy.ext.asyncio import AsyncSession  from app.db.repository import UserRepo from app.keyboards import reply from app.handlers.group_leader import CreateGroup  router = Router()  @router.message(CommandStart()) async def cmd_start(message: Message, session: AsyncSession):     user_repo = UserRepo(session)     user = await user_repo.get_user_with_group_info(message.from_user.id)      if not user: # –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏, —ç—Ç–æ–≥–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å, –Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏         user = await user_repo.get_or_create_user(             telegram_id=message.from_user.id,             username=message.from_user.username,             first_name=message.from_user.first_name,             last_name=message.from_user.last_name         )      # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ—Å—Ç–æ–∏—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –≥—Ä—É–ø–ø–µ     if user.group_membership:         if user.group_membership.is_leader:             await message.answer(                 f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, —Å—Ç–∞—Ä–æ—Å—Ç–∞ –≥—Ä—É–ø–ø—ã ¬´{user.group_membership.group.name}¬ª!",                 reply_markup=reply.main_menu_leader             )         # ... –∑–¥–µ—Å—å –±—É–¥—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ is_assistant –∏ –æ–±—ã—á–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞         else:              await message.answer(f"–í—ã —É—á–∞—Å—Ç–Ω–∏–∫ –≥—Ä—É–ø–ø—ã ¬´{user.group_membership.group.name}¬ª")     else:         await message.answer(             "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã –µ—â–µ –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –≥—Ä—É–ø–ø–µ.\n\n–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π.",             reply_markup=reply.main_menu_unregistered         )  @router.message(F.text == "üöÄ –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É") async def start_create_group(message: Message, state: FSMContext, session: AsyncSession):     user_repo = UserRepo(session)     user = await user_repo.get_user_with_group_info(message.from_user.id)     if user.group_membership:         await message.answer("–í—ã —É–∂–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –≥—Ä—É–ø–ø–µ. –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–Ω—É.")         return          await state.set_state(CreateGroup.waiting_for_name)     await message.answer("–û—Ç–ª–∏—á–Ω–æ! –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –≤–∞—à–µ–π –Ω–æ–≤–æ–π –≥—Ä—É–ø–ø—ã:")`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

**app/handlers/group_leader.py** (–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—Ç–∞—Ä–æ—Å—Ç—ã)

      `from aiogram import Router, F from aiogram.types import Message from aiogram.fsm.state import StatesGroup, State from aiogram.fsm.context import FSMContext from sqlalchemy.ext.asyncio import AsyncSession  from app.db.repository import GroupRepo from app.keyboards import reply  router = Router()  class CreateGroup(StatesGroup):     waiting_for_name = State()  @router.message(CreateGroup.waiting_for_name) async def process_group_name(message: Message, state: FSMContext, session: AsyncSession):     group_name = message.text     if len(group_name) > 50:         await message.answer("–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤.")         return      group_repo = GroupRepo(session)     await group_repo.create_group(name=group_name, creator_id=message.from_user.id)          await state.clear()     await message.answer(         f"üéâ –ì—Ä—É–ø–ø–∞ ¬´{group_name}¬ª —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞! –í—ã —Ç–µ–ø–µ—Ä—å –µ—ë —Å—Ç–∞—Ä–æ—Å—Ç–∞.",         reply_markup=reply.main_menu_leader     )  @router.message(F.text == "üìÖ –°–æ–±—ã—Ç–∏—è –∏ –ë—Ä–æ–Ω—å") async def handle_events_and_booking(message: Message):     # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ "–°–æ–±—ã—Ç–∏—è –∏ –ë—Ä–æ–Ω—å"     await message.answer("–†–∞–∑–¥–µ–ª '–°–æ–±—ã—Ç–∏—è –∏ –ë—Ä–æ–Ω—å' –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.")  @router.message(F.text == "üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã") async def handle_group_members(message: Message):     # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ "–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã"     await message.answer("–†–∞–∑–¥–µ–ª '–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã' –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.")  @router.message(F.text == "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä—É–ø–ø—ã") async def handle_group_settings(message: Message):     # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä—É–ø–ø—ã"     await message.answer("–†–∞–∑–¥–µ–ª '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä—É–ø–ø—ã' –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.")`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

**app/handlers/admin.py, group_assistant.py, group_member.py** (–ó–∞–≥–ª—É—à–∫–∏)

      `# –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –±—É–¥–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –Ω–∞ —Å—Ç–∞—Ä—Ç–µ: from aiogram import Router  router = Router()  # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ä–æ–ª–∏ # –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è admin.py: # @router.message(Command("admin_panel")) # async def show_admin_panel(...): #     ...`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

**app/utils/tools.py** (–ü–æ–∫–∞ –ø—É—Å—Ç–æ–π, –¥–ª—è –±—É–¥—É—â–∏—Ö —É—Ç–∏–ª–∏—Ç)

      `# –ó–¥–µ—Å—å –º–æ–≥—É—Ç –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: # - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π # - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç # - –∏ —Ç.–¥.`
    

IGNORE_WHEN_COPYING_START

Use code [with caution](https://support.google.com/legal/answer/13505487). Python

IGNORE_WHEN_COPYING_END

---

### –®–∞–≥ 3: –ö–∞–∫ —ç—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL** –Ω–∞ —Å–≤–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å.
    
2. **–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –∏–º–µ–Ω–µ–º stud_bot_db).
    
3. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-—Å–∫—Ä–∏–ø—Ç**, –∫–æ—Ç–æ—Ä—ã–π —è –¥–∞–≤–∞–ª –≤ **–ø—Ä–µ–¥—ã–¥—É—â–µ–º –æ—Ç–≤–µ—Ç–µ**, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –≤ —ç—Ç–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
    
4. **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ/—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã** –∏–∑ —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞–ø–∫–∏.
    
5. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** pip install -r requirements.txt.
    
6. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª .env** –≤–∞—à–∏–º —Ç–æ–∫–µ–Ω–æ–º –±–æ—Ç–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î.
    
7. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:** python bot.py.
    

–¢–µ–ø–µ—Ä—å –≤–∞—à –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è. –ù–∞–ø–∏—à–∏—Ç–µ –µ–º—É /start. –û–Ω –¥–æ–ª–∂–µ–Ω –≤–∞—Å –ø–æ–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã –æ–Ω –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–∑–Ω–∞—Ç—å –≤–∞—Å —Å—Ç–∞—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É.

–≠—Ç–æ –ø—Ä–æ—á–Ω—ã–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π —Å–∫–µ–ª–µ—Ç. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, —Ñ–∞–π–ª –∑–∞ —Ñ–∞–π–ª–æ–º, –¥–æ–±–∞–≤–ª—è—Ç—å –æ—Å—Ç–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª. –£–¥–∞—á–∏, –∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –∫—Ä–∞–¥–∏—Ç–µ –º–µ–Ω—è. –Ø –µ—â–µ –ø—Ä–∏–≥–æ–∂—É—Å—å.